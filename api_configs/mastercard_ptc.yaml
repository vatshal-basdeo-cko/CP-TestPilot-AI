name: "Mastercard PTC Authorisation"
version: "1.0.0"
description: "Process Mastercard payment authorization transactions through the Payment Test Center (PTC) API"
base_url: "http://cp-ptc.qa.internal/mastercard"

endpoints:
  - name: "authorize"
    path: "/authorizations/{payment_id}/paytocard"
    method: "POST"
    description: "Authorize a payment transaction"
    
    parameters:
      - name: "payment_id"
        in: "path"
        type: "string"
        required: true
        description: "Unique payment identifier"
        example: "pay_kgaohkfk72ketfpxkf55gpytwu"
    
    request_schema:
      type: "object"
      required: ["amount", "currency", "service_type", "entity_id", "sequence_number", "sender", "recipient", "card"]
      properties:
        service_type:
          type: "string"
          example: "mastercard_iso"
          enum: ["mastercard_iso", "mastercard_send_p2p", "mastercard_send_disbursement"]
          description: "Type of service transaction"
        action_id:
          type: "string"
          example: "act_srybfiwd2tse5lnzaypdlomcgy"
        transaction_id:
          type: "string"
          format: "uuid"
          example: "94602700-a0f4-4c00-b437-446790fd330c"
        transaction_purpose:
          type: "integer"
          example: 11
        entity_id:
          type: "string"
          example: "ent_yxjejosd7auuvm6w56i4fljye4"
        processing_key:
          type: "string"
        amount:
          type: "integer"
          description: "Transaction amount (in minor units)"
          example: 1234
        merchant_category_code:
          type: "string"
          pattern: "^[0-9]{4}$"
          example: "6536"
        currency:
          type: "string"
          pattern: "^[a-zA-Z]{3}$"
          description: "Three-letter ISO currency code"
          example: "USD"
        fund_transfer_type:
          type: "string"
          example: "C55"
        card_acceptor_name_location:
          type: "string"
          example: "Revolut* - 2979        GBR           LTU"
        card_acceptor_country_code:
          type: "string"
          example: "GBR"
        card_acceptor_postal_code:
          type: "string"
          example: "36006"
        card_acceptor_street_address:
          type: "string"
          example: "string"
        card_acceptor_address_line1:
          type: "string"
          example: "Somewhere Street"
        card_acceptor_address_line2:
          type: "string"
          example: "Somewhere Street"
        card_acceptor_city:
          type: "string"
          example: "City"
        card_acceptor_state:
          type: "string"
          example: "AL"
        cko_vault_id:
          type: "string"
          example: "c951b3f1-3011-4045-bb6c-e432a9e5de3f"
        card:
          type: "object"
          properties:
            card_number:
              type: "string"
              example: "5302318144933769"
            expiry_month:
              type: "integer"
              example: 8
            expiry_year:
              type: "integer"
              example: 2027
        recipient:
          type: "object"
          properties:
            first_name: { type: "string" }
            last_name: { type: "string" }
            account_number: { type: "string" }
            address: { type: "string" }
            city: { type: "string" }
            country: { type: "string" }
        sender:
          type: "object"
          properties:
            first_name: { type: "string" }
            last_name: { type: "string" }
            account_number: { type: "string" }
            address: { type: "string" }
            city: { type: "string" }
            country: { type: "string" }
        merchant_acquirer_configuration:
          type: "object"
          properties:
            processing_profile:
              type: "object"
            acquirer:
              type: "object"
            sequence_number: { type: "integer" }

    response_schema:
      type: "object"
      properties:
        response_code:
            type: "string"
        response_message:
            type: "string"
    
    expected_status_codes:
      - code: 201
        description: "Created - Authorization successful"
      - code: 202
        description: "Accepted - Processing"
      - code: 422
        description: "Unprocessable Entity - Validation Error"
      - code: 500
        description: "Server Error"

    examples:
      - name: "Mastercard ISO Authorization"
        request:
          service_type: "mastercard_iso"
          action_id: "act_srybfiwd2tse5lnzaypdlomcgy"
          transaction_id: "94602700-a0f4-4c00-b437-446790fd330c"
          transaction_purpose: 11
          entity_id: "ent_yxjejosd7auuvm6w56i4fljye4"
          processing_key: "pp_4qwg6eib2udu5eteo2uxaiuxom"
          amount: 1234
          merchant_category_code: "6536"
          currency: "USD"
          fund_transfer_type: "C55"
          card_acceptor_name_location: "Revolut* - 2979        GBR           LTU"
          card_acceptor_country_code: "GBR"
          card_acceptor_postal_code: "36006"
          card_acceptor_street_address: "string"
          card_acceptor_address_line1: "Somewhere Street"
          card_acceptor_address_line2: "Somewhere Street"
          card_acceptor_city: "City"
          card_acceptor_state: "AL"
          cko_vault_id: "c951b3f1-3011-4045-bb6c-e432a9e5de3f"
          card:
             card_number: "5302318144933769"
             expiry_month: 8
             expiry_year: 2027
          recipient:
            first_name: "John"
            last_name: "younis"
            # ... (truncated for brevity, fields are consistent)
          sender:
            first_name: "Adrise"
            last_name: "lastname"
            # ... (truncated for brevity)
          merchant_acquirer_configuration:
             processing_profile: { "id": "pp_4qwg6eib2udu5eteo2uxaiuxom" }
             acquirer: { "acquirer_key": "cko_mc_gb" }
             sequence_number: 1000000000
    
      - name: "Mastercard Send P2P Authorization"
        request:
          service_type: "mastercard_send_p2p"
          action_id: "act_p2p_example_123"
          transaction_id: "uuid-p2p-001"
          transaction_purpose: 11
          entity_id: "ent_yxjejosd7auuvm6w56i4fljye4"
          processing_key: "pp_4qwg6eib2udu5eteo2uxaiuxom"
          amount: 5000
          merchant_category_code: "6536"
          currency: "USD"
          fund_transfer_type: "AA" # Example for P2P
          card_acceptor_name_location: "P2P Transfer"
          card_acceptor_country_code: "GBR"
          card_acceptor_postal_code: "36006"
          card_acceptor_street_address: "P2P Street"
          card_acceptor_city: "London"
          card_acceptor_state: "LND"
          cko_vault_id: "vault_id_123"
          card:
             card_number: "5302318144933769"
             expiry_month: 12
             expiry_year: 2028
          recipient:
             first_name: "Alice"
             last_name: "Receiver"
             # ...
          sender:
             first_name: "Bob"
             last_name: "Sender"
             # ...
          merchant_acquirer_configuration:
             processing_profile: { "id": "pp_4qwg6eib2udu5eteo2uxaiuxom" }
             acquirer: { "acquirer_key": "cko_mc_gb" }
             sequence_number: 1000000001

      - name: "Mastercard Send Disbursement Authorization"
        request:
          service_type: "mastercard_send_disbursement"
          action_id: "act_disburse_example_456"
          transaction_id: "uuid-disburse-002"
          transaction_purpose: 11
          entity_id: "ent_yxjejosd7auuvm6w56i4fljye4"
          processing_key: "pp_4qwg6eib2udu5eteo2uxaiuxom"
          amount: 25000
          merchant_category_code: "6536"
          currency: "USD"
          fund_transfer_type: "BB" # Example for Disbursement
          card_acceptor_name_location: "Insurance Claim Payout"
          card_acceptor_country_code: "USA"
          card_acceptor_postal_code: "10001"
          card_acceptor_street_address: "Insurance Plaza"
          card_acceptor_city: "New York"
          card_acceptor_state: "NY"
          cko_vault_id: "vault_id_456"
          card:
             card_number: "5302318144933769"
             expiry_month: 6
             expiry_year: 2026
          recipient:
             first_name: "Charlie"
             last_name: "Claimant"
             # ...
          sender:
             first_name: "Global Insurance Co"
             last_name: "Corp"
             # ...
          merchant_acquirer_configuration:
             processing_profile: { "id": "pp_4qwg6eib2udu5eteo2uxaiuxom" }
             acquirer: { "acquirer_key": "cko_mc_gb" }
             sequence_number: 1000000002

test_scenarios:
  - scenario: "Standard Authorization"
    natural_language: "Authorize payment for payment_id pay_xyz"
    expected_status: 201
  
metadata:
  api_provider: "Mastercard"
  environment: "test"
  documentation_url: "https://github.com/cko-card-processing/mastercard-ptc-api"
